<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.2.xsd">
	
	<bean id="minuteIntervalScheduler" class="com.abudko.scheduled.jobs.csv.MinuteIntervalScheduler"/>

	<bean name="minuteIntervalJob" class="org.springframework.scheduling.quartz.JobDetailFactoryBean">
		<property name="name" value="minuteIntervalJob"/>
        <property name="jobClass" value="com.abudko.scheduled.jobs.csv.MinuteIntervalJob"/>
    </bean>

	<bean id="minuteIntervalTrigger" class="org.springframework.scheduling.quartz.CronTriggerFactoryBean">
        <property name="jobDetail" ref="minuteIntervalJob"/>
        <property name="cronExpression" value="0 0/30 * * * ?"/>
    </bean>
    
	<bean id="hourIntervalScheduler" class="com.abudko.scheduled.jobs.csv.HourIntervalScheduler"/>

	<bean name="hourIntervalJob" class="org.springframework.scheduling.quartz.JobDetailFactoryBean">
		<property name="name" value="hourIntervalJob"/>
        <property name="jobClass" value="com.abudko.scheduled.jobs.csv.HourIntervalJob"/>
    </bean>

	<bean id="hourIntervalTrigger" class="org.springframework.scheduling.quartz.CronTriggerFactoryBean">
        <property name="jobDetail" ref="hourIntervalJob"/>
        <property name="cronExpression" value="0 0 0/4 * * ?"/>
    </bean>
    
	<bean id="dayIntervalScheduler" class="com.abudko.scheduled.jobs.csv.DayIntervalScheduler"/>

	<bean name="dayIntervalJob" class="org.springframework.scheduling.quartz.JobDetailFactoryBean">
		<property name="name" value="dayIntervalJob"/>
        <property name="jobClass" value="com.abudko.scheduled.jobs.csv.DayIntervalJob"/>
    </bean>

	<bean id="dayIntervalTrigger" class="org.springframework.scheduling.quartz.CronTriggerFactoryBean">
        <property name="jobDetail" ref="dayIntervalJob"/>
        <property name="cronExpression" value="0 0 10 * * ?"/>
    </bean>
   
    <bean class="org.springframework.scheduling.quartz.SchedulerFactoryBean">
   		<property name="jobFactory">
   			<bean class="org.springframework.scheduling.quartz.SpringBeanJobFactory"/>
   		</property>
   		<property name="schedulerContextAsMap">
   			<map>
   				<entry key="minuteIntervalScheduler" value-ref="minuteIntervalScheduler" />
   				<entry key="hourIntervalScheduler" value-ref="hourIntervalScheduler" />
   				<entry key="dayIntervalScheduler" value-ref="dayIntervalScheduler" />
   			</map>
   		</property>
        <property name="quartzProperties">
			<props>
				<prop key="org.quartz.scheduler.instanceId">AUTO</prop>

				<prop key="org.quartz.threadPool.class">org.quartz.simpl.SimpleThreadPool</prop>
				<prop key="org.quartz.threadPool.threadCount">1</prop>
				<prop key="org.quartz.threadPool.threadPriority">5</prop>

				<prop key="org.quartz.scheduler.skipUpdateCheck">true</prop>
			</props>
		</property>

        <property name="waitForJobsToCompleteOnShutdown" value="true"/>
        <property name="autoStartup" value="true"/>
        <property name="startupDelay" value="30" />
        <property name="triggers">
            <list>
            	<!-- <ref bean="minuteIntervalTrigger"/> -->
      			<ref bean="hourIntervalTrigger"/>
      			<ref bean="dayIntervalTrigger"/>
            </list>
        </property>
    </bean>

</beans>
